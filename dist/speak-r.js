!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("ramda"),require("sanctuary"),require("debug")):"function"==typeof define&&define.amd?define(["ramda","sanctuary","debug"],e):t.speaker=e(t.R,t.sanctuary,t.debug)}(this,function(t,e,n){"use strict";function r(t,e){return e={exports:{}},t(e,e.exports),e.exports}t="default"in t?t.default:t,e="default"in e?e.default:e,n="default"in n?n.default:n;var i=r(function(t){var e={doubledots:"::",comma:",",dash:"_",arrow:"->",doublearrow:"=>",middlepipe:"<|>",backpipe:"<|",forwardpipe:"|>",equals:"==",plus:"+",minus:"-",map:"^"},n={type:"type",R:"R",string:"string",number:"number",op:"operator",any:"any",context:"context",lex:"lexeme"},r=[["Array",Array],["Number",Number],["String",String],["Function",Function],["Object",Object],["Null",null],["RegExp",RegExp]],i=['"',"'","`"],o={piped:[n.R,n.context,n.lex],inserted:[n.number,n.string,n.type,n.any],control:[n.op]},p={pipe:"Pipe",context:"Context",atomic:"AtomicFunc",expr:"Expression"};t.exports={op:e,types:n,quotes:i,categories:o,jstypes:r,lexemeTypes:p}}),o=r(function(e){var n=t,r=n.curry(function(t,e){return{type:t,value:e}});e.exports={Type:r("type"),R:r("R"),String:r("string"),Number:r("number"),Operator:r("operator"),Any:r("any"),Context:r("context")}}),p=r(function(e){function n(t){return function e(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return u(n,t)&&t.push(i.apply(t.pop())(n)),e}}function r(t){var e=[],r=n(e);return r.exec=function(){return i.apply(i.pipe,e)},r.toString=function(){return""},Object.defineProperty(r,"store",{get:function(){return e}}),Object.defineProperty(r,"exec",{get:function(){return i.apply(i.pipe,e)}}),a(e,r,t),r}var i=t,o=function(t,e){return function(n){return Object.defineProperty(e,n[0],{get:function(){return t(n[1]),e}})}},p=function(t){return function(e){return t.push(e)}},u=function(t,e){return!i.isEmpty(t)&&!i.is(Function,t[0])&&i.none(i.isNil,t)&&!i.isEmpty(e)},a=function(t,e,n){return i.pipe(i.toPairs,i.forEach(o(p(t),e)))(n)},s={};Object.defineProperty(s,"do",{get:function(){return r(i)}}),e.exports=s}),u=r(function(e){var r=t,i=n,o=p,u=function(t,e){return r.isNil(e)?t:[t,e].join(":  ")},a=function(t){return function(e){return i(u(t,e))}},s=function(t){return function(e){return r.tap(a(t)(e))}},c=r.apply(r.pipe),f=function(t,e){return r.ifElse(r.is(Array),r.concat(t),r.append(r.__,t))(e)},l=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return c(r.reduce(f,[],t))},d=r.unless(r.is(Array),r.of),y=l(d,r.flip(r.contains)),h=r.is(String),m={type:r.prop("type"),val:r.prop("value"),head:r.prop("head"),tail:r.prop("tail")};e.exports={pipelog:s,log:a,isString:h,arrayify:d,toPipe:c,P:l,isContainOrEq:y,prop:m,RP:o}}),a=r(function(n){var r=t,p=e,a=i,s=o,c=u,f=c.isString,l=function(t,e,n){var i=r.pipe(c.arrayify,r.allPass,p.either(r.__,r.F)),o=r.flip(r.concat)([t,p.Right]),u=r.pipe(r.defaultTo([]),c.arrayify,o,c.toPipe,p.either(r.__,r.identity));return r.when(i(e),u(n))},d=function(){var t=r.anyPass(r.map(r.equals,a.quotes)),e=r.allPass(r.map(function(e){return r.pipe(e,t)},[r.head,r.last])),n=r.pipe(r.init,r.tail);return l(s.String,[f,e],[r.trim,n])},y=function(){var t=new Map(a.jstypes),e=function(e){return!!f(e)&&t.has(e)};return l(s.Type,e,function(e){return t.get(e)})},h=l(s.Number,isFinite,parseFloat),m=function(){var t=r.is(Function),e=function(e){return t(r[e])};return l(s.R,[f,e],r.prop(r.__,r))},x=function(t){return r.pipe(r.match(/\D\w+/),r.head,r.equals(t))(t)},g=l(s.Context,x),v=p.lift(r.when(f,r.trim)),b=r.identity;n.exports={isQuote:d(),isType:y(),isVendor:m(),isNumber:h,isContext:g,preprocess:v,postprocess:b}}),s=r(function(e){var n=t,r=u,p=o,a=r.pipelog("splitter"),s=n.values(i.op),c=r.toPipe,f=function(t){return n.map(n.when(r.isString,t))},l=f(n.trim),d=n.reject(n.isEmpty),y=[n.split,n.pipe(p.Operator,n.intersperse)],h=[d,n.unnest],m=function(t){return n.cond([[n.is(String),t],[n.T,a("uncaught")]])},x=function(t){return n.pipe(t,n.unnest)},g=[n.of,n.ap(y),n.concat(n.__,h),c,m,n.map,x,a("splitPipe")],v=n.pipe(c,n.map(n.__,s),c)(g),b=n.pipe(n.unnest,l,d,a("end")),P=[r.arrayify,v,b],w=c(P);e.exports={exec:w,cleaner:b}}),c=r(function(n){var r=t,i=e,o=a,p=s,c=u,f=c.pipelog("preproc"),l=r.pipe(o.preprocess,f("->isQuote"),o.isQuote,f("->isNumber"),o.isNumber,f("->isType"),o.isType,f("->isVendor"),o.isVendor,f("->isContext"),o.isContext,f("->postprocess"),o.postprocess),d=r.unary(r.pipe(r.unless(c.isString,function(){throw new Error("`keywords` should be String")}),r.split(" "),r.reject(r.isEmpty),p.exec,r.map(r.ifElse(r.is(Object),i.Right,i.Left)),f("тэг"),r.map(l),r.dropRepeatsWith(function(t,e){return r.allPass([r.propEq("type","operator"),r.propEq("obj",","),r.eqProps("obj",r.__,e)])(t)})));n.exports=d}),f=r(function(e){var n=t,r=i.lexemeTypes,o=function(t,e){return e.index=e.head.index,e.lexeme=t,e},p=function(){},u={its:{}};p.Pipe=function(t){return new o(r.pipe,t)},p.AtomicFunc=function(t){return new o(r.atomic,t)},p.Expression=function(t){return new o(r.expr,t)},u.its.get=function(){var t=n.propEq("lexeme");return n.map(t,r)},p.Context=function(t){return new p(r.context,t)},Object.defineProperties(p,u),e.exports=p}),l=r(function(n){var r=t,i=e,o=u,p=o.P,a=function(t,e){return!r.is(Array,t)||r.isEmpty(t)?i.Left("No array recieved"):void(r.isNil(e)?(this.head=r.head(t),this.tail=r.tail(t)):(this.head=e,this.tail=t||[]))},s={toArray:{},length:{}};a.prototype.map=function(t){return r.map(t,this.toArray)},s.toArray.get=function(){return r.prepend(this.head,this.tail)},s.length.get=function(){return r.defaultTo(0,this.tail.length)+r.isEmpty(this.head)?0:1},a.prototype.append=function(t){return r.isEmpty(this.tail)&&r.isEmpty(this.head)?this.head=t:this.tail.push(t),this},a.hasTail=function(t){return r.has("tail",t)&&!r.isEmpty(t.tail)},a.last=function(t){return a.hasTail(t)?r.last(t.tail):t.head},a.lastR=function(t,e){void 0===e&&(e=!1);var n=r.has("tail"),i=p(n,r.not),o=r.either(i,p(a.last,i));return r.until(e?o:i,a.last)(t)},a.emptyList=function(){return new a([{}])},a.isList=function(t){return r.has("head",t)},Object.defineProperties(a.prototype,s),n.exports=a}),d=r(function(e){function n(t){return function e(n){return o.ifElse(o.either(o.isNil,function(){return o.isEmpty(t)}),function(){return e},o.anyPass(t))(n)}}function r(t){var e=[],r=n(e);return Object.defineProperty(r,"store",{get:function(){return e}}),x(e,r,t),r}var o=t,p=u,a=p.P,s=i,c=s.types,f=s.op,l=function(t){return function(e){return o.whereEq({type:t,value:e})}},d=l(c.op),y=o.propEq("type"),h=function(t,e){return function(n){return Object.defineProperty(e,n[0],{get:function(){return t(n[1]),e}})}},m=function(t){return function(e){return t.push(e)}},x=function(t,e,n){return a(o.toPairs,o.forEach(h(m(t),e)))(n)},g={op:o.map(d)(f),type:o.map(y)(c),typedVal:o.map(l)(c)},v={};Object.defineProperty(v,"op",{get:function(){return r(g.op)}}),Object.defineProperty(v,"type",{get:function(){return r(g.type)}}),Object.defineProperty(v,"typedVal",{get:function(){return r(g.typedVal)}}),e.exports={eq:g,equals:v}}),y=r(function(n){function r(t){var e=function(t,e){return x.lift(m.assoc("index",e))(t)},n=function(t){return t.map(e)};return v(m.map(x.eitherToMaybe),n)(t)}function o(t){return t}function p(t,e,n){var r=b.do.length.dec.lensIndex.exec,i=function(t){return m.append(N.Pipe(new E([t])))},o=function(t){return function(e){return m.ifElse(m.isEmpty,i(t),m.over(r(e),n(t)))(e)}},p=m.map(m.ifElse(t,e,o));return m.transduce(p,function(t,e){return e(t)})}function a(t){var e=function(t){return v(g.arrayify,m.append(t.value))},n=v(w.val,q.type.R.op.context),r=v(w.val,m.of,m.append),i=p(n,r,e);return i([],t)}function s(t){var e=function(t){return function(e){return e.append(t)}},n=q.op.forwardpipe.middlepipe.backpipe,r=m.both(E.isList,v(w.head,n)),i=v(m.identity,m.append),o=p(r,i,e);return o([],t)}function c(t){var e=[[q.op.dash,j.any,m.__],[q.op.equals,j.R,m.equals],[q.op.plus,j.R,m.add],[q.op.minus,j.R,m.subtract],[q.op.map,j.R,m.map]],n=function(t,e){return function(n){return n.value=e,n.type=t,n}},r=function(t,e,r){return m.map(m.when(t,n(e,r)))},i=function(t,e){return m.apply(r,e)(t)},o=function(t){return function(e){return m.reduce(i,e,t)}},p=o(e);return p(t)}function y(t){var e=m.when(v(w.head,q.type.R),N.AtomicFunc),n=m.when(v(w.head,q.type.op),N.Expression),r=v(function(t){return new E(t)},e,n),i=v(x.lift(c),a,m.map(r));return i(t)}function h(t){return v(r,o,P("lexemize<-"),y,P("intoPipes"),s)(t)}var m=t,x=e,g=u,v=g.P,b=g.RP,P=g.pipelog("tree"),w=g.prop,N=f,E=l,j=i.types,R=d,q=R.equals;n.exports=h}),h=r(function(n){function r(t){var e=p.when(h.its.expr,c(s.prop.tail,function(t){return new y(t)},h.Pipe)),n=p.when(p.both(h.its.pipe,c(y.hasTail,p.not)),s.prop.head);return c(e,n)(t)}function i(){var t=this;this.value=[],this.push=function(e){return t.value.push(j(e))},this.pushLast=function(e){return t.push(y.lastR(e,!0))},this.pop=function(){return t.value.pop()},this.addToLast=function(e){return p.last(t.value)(e)}}function o(t){if(!p.is(Array,t))return a.Left("No array recieved");for(var e=y.emptyList(),n=new i,o=v.empty,u=0;u<t.length;){var s=t[u],f=N(s),l=E[o][f];switch(l){case b.child:n.pushLast(e);break;case b.parent:n.pop()}o=f,n.addToLast(r(s)),u++}return c(h.Pipe,r)(e)}var p=t,a=e,s=u,c=s.P,y=(s.log("tree"),s.pipelog("tree"),l),h=f,m=d,x=m.eq.op,g=["pipe","open","mid","close"],v={empty:0,pipe:1,open:2,mid:3,close:4},b={next:0,child:1,parent:-1,error:NaN},P=function(t){return p.both(h.its.expr,c(s.prop.head,t))},w={pipe:h.its.pipe,open:P(x.backpipe),mid:P(x.middlepipe),close:P(x.forwardpipe)},N=p.cond(p.append([p.T,v.pipe],p.map(function(t){return[w[t],function(){return v[t]}]},g))),E=[[NaN,1,1,NaN,1],[NaN,0,1,NaN,0],[NaN,-1,1,0,-1],[NaN,-1,1,0,-1],[NaN,0,1,NaN,0]],j=function(t){return function(e){return t.append(e)}};n.exports=o}),m=r(function(e){function n(t){this.message="Can not compile object "+t,this.name="Compile exeption"}function r(t){var e=a.cond([[a.is(Array),i],[y(s.isList,a.not),d.prop.val],[c.its.pipe,i],[c.its.atomic,o],[a.T,function(t){throw new n(t)}]]);return e(t)}function i(t){var e=a.when(s.isList,a.prop("toArray"));return y(e,a.map(r),a.apply(a.pipe))(t)}function o(t){return s.hasTail(t)?a.apply(r(t.head),a.map(r,t.tail)):r(t.head)}function p(t){return r(t)}var a=t,s=l,c=f,d=u,y=d.P;e.exports=p}),x=r(function(t){function e(t){return p(n,r,i,s)(t)}var n=c,r=y,i=h,o=u,p=o.P,a=o.log("index"),s=m,f="data sright :: head prop 'index' splitAt _ @data sright",l="when <| == 1 not <|> + 10 |> + 100";a("example")(f);e(l);t.exports=e});return x});
//# sourceMappingURL=speak-r.js.map
