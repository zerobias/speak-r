!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("ramda"),require("debug"),require("sanctuary")):"function"==typeof define&&define.amd?define(["ramda","debug","sanctuary"],e):t.speaker=e(t.R,t.debug,t.sanctuary)}(this,function(t,e,n){"use strict";function r(t,e){return e={exports:{}},t(e,e.exports),e.exports}t="default"in t?t.default:t,e="default"in e?e.default:e,n="default"in n?n.default:n;var i=r(function(t){var e={doubledots:"::",comma:",",dash:"_",arrow:"->",doublearrow:"=>",middlepipe:"<|>",backpipe:"<|",forwardpipe:"|>",equals:"==",plus:"+",minus:"-",map:"^"},n={type:"type",R:"R",string:"string",number:"number",op:"operator",any:"any",context:"context",lex:"lexeme"},r=[["Array",Array],["Number",Number],["String",String],["Function",Function],["Object",Object],["Null",null],["RegExp",RegExp]],i=['"',"'","`"],o={piped:[n.R,n.context,n.lex],inserted:[n.number,n.string,n.type,n.any],control:[n.op]},p={pipe:"Pipe",context:"Context",atomic:"AtomicFunc",expr:"Expression"};t.exports={op:e,types:n,quotes:i,categories:o,jstypes:r,lexemeTypes:p}}),o=r(function(e){var n=t,r=n.curry(function(t,e){return{type:t,value:e}});e.exports={Type:r("type"),R:r("R"),String:r("string"),Number:r("number"),Operator:r("operator"),Any:r("any"),Context:r("context")}}),p=r(function(e){function n(t){return function e(){for(var n=[],r=arguments.length;r--;)n[r]=arguments[r];return u(n,t)&&t.push(i.apply(t.pop())(n)),e}}function r(t){var e=[],r=n(e);return r.exec=function(){return i.apply(i.pipe,e)},r.toString=function(){return""},Object.defineProperty(r,"store",{get:function(){return e}}),Object.defineProperty(r,"exec",{get:function(){return i.apply(i.pipe,e)}}),a(e,r,t),r}var i=t,o=function(t,e){return function(n){return Object.defineProperty(e,n[0],{get:function(){return t(n[1]),e}})}},p=function(t){return function(e){return t.push(e)}},u=function(t,e){return!i.isEmpty(t)&&!i.is(Function,t[0])&&i.none(i.isNil,t)&&!i.isEmpty(e)},a=function(t,e,n){return i.pipe(i.toPairs,i.forEach(o(p(t),e)))(n)},s={};Object.defineProperty(s,"do",{get:function(){return r(i)}}),e.exports=s}),u=r(function(r){var i=t,o=e,u=p,a=function(t,e){return i.isNil(e)?t:[t,e].join(":  ")},s=function(t){return function(e){return o(a(t,e))}},c=function(t){return function(e){return i.tap(s(t)(e))}},f=i.apply(i.pipe),l=function(t,e){return i.ifElse(i.is(Array),i.concat(t),i.append(i.__,t))(e)},d=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return f(i.reduce(l,[],t))},y=i.unless(i.is(Array),i.of),h=d(y,i.flip(i.contains)),m=i.is(String),x=n.create,v=n.env,g=!1,b=x({checkTypes:g,env:v}),P={type:i.prop("type"),val:i.prop("value"),head:i.prop("head"),tail:i.prop("tail")};r.exports={pipelog:c,log:s,isString:m,arrayify:y,toPipe:f,P:d,isContainOrEq:h,prop:P,RP:u,S:b}}),a=r(function(e){var n=t,r=i,p=o,a=u,s=a.S,c=a.isString,f=function(t,e,r){var i=n.pipe(a.arrayify,n.allPass,s.either(n.__,n.F)),o=n.flip(n.concat)([t,s.Right]),p=n.pipe(n.defaultTo([]),a.arrayify,o,a.toPipe,s.either(n.__,n.identity));return n.when(i(e),p(r))},l=function(){var t=n.anyPass(n.map(n.equals,r.quotes)),e=n.allPass(n.map(function(e){return n.pipe(e,t)},[n.head,n.last])),i=n.pipe(n.init,n.tail);return f(p.String,[c,e],[n.trim,i])},d=function(){var t=new Map(r.jstypes),e=function(e){return!!c(e)&&t.has(e)};return f(p.Type,e,function(e){return t.get(e)})},y=f(p.Number,isFinite,parseFloat),h=function(){var t=n.is(Function),e=function(e){return t(n[e])};return f(p.R,[c,e],n.prop(n.__,n))},m=function(t){return n.pipe(n.match(/\D\w+/),n.head,n.equals(t))(t)},x=f(p.Context,m),v=s.lift(n.when(c,n.trim)),g=n.identity;e.exports={isQuote:l(),isType:d(),isVendor:h(),isNumber:y,isContext:x,preprocess:v,postprocess:g}}),s=r(function(e){var n=t,r=u,p=o,a=r.pipelog("splitter"),s=n.values(i.op),c=r.toPipe,f=function(t){return n.map(n.when(r.isString,t))},l=f(n.trim),d=n.reject(n.isEmpty),y=[n.split,n.pipe(p.Operator,n.intersperse)],h=[d,n.unnest],m=function(t){return n.cond([[n.is(String),t],[n.T,a("uncaught")]])},x=function(t){return n.pipe(t,n.unnest)},v=[n.of,n.ap(y),n.concat(n.__,h),c,m,n.map,x,a("splitPipe")],g=n.pipe(c,n.map(n.__,s),c)(v),b=n.pipe(n.unnest,l,d,a("end")),P=[r.arrayify,g,b],w=c(P);e.exports={exec:w,cleaner:b}}),c=r(function(e){var n=t,r=a,i=s,o=u,p=o.S,c=o.pipelog("preproc"),f=n.pipe(r.preprocess,c("->isQuote"),r.isQuote,c("->isNumber"),r.isNumber,c("->isType"),r.isType,c("->isVendor"),r.isVendor,c("->isContext"),r.isContext,c("->postprocess"),r.postprocess),l=n.unary(n.pipe(n.unless(o.isString,function(){throw new Error("`keywords` should be String")}),n.split(" "),n.reject(n.isEmpty),i.exec,n.map(n.ifElse(n.is(Object),p.Right,p.Left)),c("тэг"),n.map(f),n.dropRepeatsWith(function(t,e){return n.allPass([n.propEq("type","operator"),n.propEq("obj",","),n.eqProps("obj",n.__,e)])(t)})));e.exports=l}),f=r(function(e){var n=t,r=i.lexemeTypes,o=function(t,e){return e.index=e.head.index,e.lexeme=t,e},p=function(){},u={its:{}};p.Pipe=function(t){return new o(r.pipe,t)},p.AtomicFunc=function(t){return new o(r.atomic,t)},p.Expression=function(t){return new o(r.expr,t)},u.its.get=function(){var t=n.propEq("lexeme");return n.map(t,r)},p.Context=function(t){return new p(r.context,t)},Object.defineProperties(p,u),e.exports=p}),l=r(function(e){var n=t,r=u,i=r.S,o=r.P,p=function(t,e){return!n.is(Array,t)||n.isEmpty(t)?i.Left("No array recieved"):void(n.isNil(e)?(this.head=n.head(t),this.tail=n.tail(t)):(this.head=e,this.tail=t||[]))},a={toArray:{},length:{}};p.prototype.map=function(t){return n.map(t,this.toArray)},a.toArray.get=function(){return n.prepend(this.head,this.tail)},a.length.get=function(){return n.defaultTo(0,this.tail.length)+n.isEmpty(this.head)?0:1},p.prototype.append=function(t){return n.isEmpty(this.tail)&&n.isEmpty(this.head)?this.head=t:this.tail.push(t),this},p.hasTail=function(t){return n.has("tail",t)&&!n.isEmpty(t.tail)},p.last=function(t){return p.hasTail(t)?n.last(t.tail):t.head},p.lastR=function(t,e){void 0===e&&(e=!1);var r=n.has("tail"),i=o(r,n.not),u=n.either(i,o(p.last,i));return n.until(e?u:i,p.last)(t)},p.emptyList=function(){return new p([{}])},p.isList=function(t){return n.has("head",t)},Object.defineProperties(p.prototype,a),e.exports=p}),d=r(function(e){function n(t){return function e(n){return o.ifElse(o.either(o.isNil,function(){return o.isEmpty(t)}),function(){return e},o.anyPass(t))(n)}}function r(t){var e=[],r=n(e);return Object.defineProperty(r,"store",{get:function(){return e}}),x(e,r,t),r}var o=t,p=u,a=p.P,s=i,c=s.types,f=s.op,l=function(t){return function(e){return o.whereEq({type:t,value:e})}},d=l(c.op),y=o.propEq("type"),h=function(t,e){return function(n){return Object.defineProperty(e,n[0],{get:function(){return t(n[1]),e}})}},m=function(t){return function(e){return t.push(e)}},x=function(t,e,n){return a(o.toPairs,o.forEach(h(m(t),e)))(n)},v={op:o.map(d)(f),type:o.map(y)(c),typedVal:o.map(l)(c)},g={};Object.defineProperty(g,"op",{get:function(){return r(v.op)}}),Object.defineProperty(g,"type",{get:function(){return r(v.type)}}),Object.defineProperty(g,"typedVal",{get:function(){return r(v.typedVal)}}),e.exports={eq:v,equals:g}}),y=r(function(e){function n(t){var e=function(t,e){return x.lift(h.assoc("index",e))(t)},n=function(t){return t.map(e)};return v(h.map(x.eitherToMaybe),n)(t)}function r(t){return t}function o(t,e,n){var r=g.do.length.dec.lensIndex.exec,i=function(t){return h.append(w.Pipe(new N([t])))},o=function(t){return function(e){return h.ifElse(h.isEmpty,i(t),h.over(r(e),n(t)))(e)}},p=h.map(h.ifElse(t,e,o));return h.transduce(p,function(t,e){return e(t)})}function p(t){var e=function(t){return v(m.arrayify,h.append(t.value))},n=v(P.val,R.type.R.op.context),r=v(P.val,h.of,h.append),i=o(n,r,e);return i([],t)}function a(t){var e=function(t){return function(e){return e.append(t)}},n=R.op.forwardpipe.middlepipe.backpipe,r=h.both(N.isList,v(P.head,n)),i=v(h.identity,h.append),p=o(r,i,e);return p([],t)}function s(t){var e=[[R.op.dash,E.any,h.__],[R.op.equals,E.R,h.equals],[R.op.plus,E.R,h.add],[R.op.minus,E.R,h.subtract],[R.op.map,E.R,h.map]],n=function(t,e){return function(n){return n.value=e,n.type=t,n}},r=function(t,e,r){return h.map(h.when(t,n(e,r)))},i=function(t,e){return h.apply(r,e)(t)},o=function(t){return function(e){return h.reduce(i,e,t)}},p=o(e);return p(t)}function c(t){var e=h.when(v(P.head,R.type.R),w.AtomicFunc),n=h.when(v(P.head,R.type.op),w.Expression),r=v(function(t){return new N(t)},e,n),i=v(x.lift(s),p,h.map(r));return i(t)}function y(t){return v(n,r,b("lexemize<-"),c,b("intoPipes"),a)(t)}var h=t,m=u,x=m.S,v=m.P,g=m.RP,b=m.pipelog("tree"),P=m.prop,w=f,N=l,E=i.types,j=d,R=j.equals;e.exports=y}),h=r(function(e){function n(t){var e=o.when(y.its.expr,s(p.prop.tail,function(t){return new c(t)},y.Pipe)),n=o.when(o.both(y.its.pipe,s(c.hasTail,o.not)),p.prop.head);return s(e,n)(t)}function r(){var t=this;this.value=[],this.push=function(e){return t.value.push(E(e))},this.pushLast=function(e){return t.push(c.lastR(e,!0))},this.pop=function(){return t.value.pop()},this.addToLast=function(e){return o.last(t.value)(e)}}function i(t){if(!o.is(Array,t))return a.Left("No array recieved");for(var e=c.emptyList(),i=new r,p=v.empty,u=0;u<t.length;){var f=t[u],l=w(f),d=N[p][l];switch(d){case g.child:i.pushLast(e);break;case g.parent:i.pop()}p=l,i.addToLast(n(f)),u++}return s(y.Pipe,n)(e)}var o=t,p=u,a=p.S,s=p.P,c=(p.log("tree"),p.pipelog("tree"),l),y=f,h=d,m=h.eq.op,x=["pipe","open","mid","close"],v={empty:0,pipe:1,open:2,mid:3,close:4},g={next:0,child:1,parent:-1,error:NaN},b=function(t){return o.both(y.its.expr,s(p.prop.head,t))},P={pipe:y.its.pipe,open:b(m.backpipe),mid:b(m.middlepipe),close:b(m.forwardpipe)},w=o.cond(o.append([o.T,v.pipe],o.map(function(t){return[P[t],function(){return v[t]}]},x))),N=[[NaN,1,1,NaN,1],[NaN,0,1,NaN,0],[NaN,-1,1,0,-1],[NaN,-1,1,0,-1],[NaN,0,1,NaN,0]],E=function(t){return function(e){return t.append(e)}};e.exports=i}),m=r(function(e){function n(t){this.message="Can not compile object "+t,this.name="Compile exeption"}function r(t){var e=a.cond([[a.is(Array),i],[y(s.isList,a.not),d.prop.val],[c.its.pipe,i],[c.its.atomic,o],[a.T,function(t){throw new n(t)}]]);return e(t)}function i(t){var e=a.when(s.isList,a.prop("toArray"));return y(e,a.map(r),a.apply(a.pipe))(t)}function o(t){return s.hasTail(t)?a.apply(r(t.head),a.map(r,t.tail)):r(t.head)}function p(t){return r(t)}var a=t,s=l,c=f,d=u,y=d.P;e.exports=p}),x=r(function(t){function e(t){return p(n,r,i,s)(t)}var n=c,r=y,i=h,o=u,p=o.P,a=o.log("index"),s=m,f="data sright :: head prop 'index' splitAt _ @data sright",l="when <| == 1 not <|> + 10 |> + 100";a("example")(f);e(l);t.exports=e});return x});
//# sourceMappingURL=speak-r.js.map
